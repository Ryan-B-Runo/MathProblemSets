<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../stylesheet.css">
    <link rel="stylesheet" href="https://latex.vercel.app/style.css">
    <title>Complete the Square</title>
</head>
<body>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<h1>Complete the Square</h1>

<div style="text-align: center">
    <a href="../index.html"><b>Home</b></a><br>
    <a href="../CollegeAlgebra"><b>College Algebra</b></a>
    <br>
    <u id="dark-mode-toggle"><b>Dark Mode</b></u>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            // Select the toggle button
            const darkModeToggle = document.querySelector("#dark-mode-toggle");

            // Function to enable dark mode
            const enableDarkMode = () => {
                document.body.classList.add("latex-dark");
                localStorage.setItem("darkMode", "enabled");
            };

            // Function to disable dark mode
            const disableDarkMode = () => {
                document.body.classList.remove("latex-dark");
                localStorage.setItem("darkMode", "disabled");
            };

            // Check localStorage when the page loads
            if (localStorage.getItem("darkMode") === "enabled") {
                enableDarkMode();
            }

            // Add event listener to the toggle button
            darkModeToggle.addEventListener('click', () => {
                // Check the current state *before* toggling
                const isDarkModeNow = document.body.classList.contains("latex-dark");

                if (isDarkModeNow) {
                    disableDarkMode();
                } else {
                    enableDarkMode();
                }
            });
        });
    </script>
</div>
<h2>Description</h2>
<article class="indent-pars">
    Generates quadratic equations can be solved by completing the square. Integer solutions given in answer key
    <br><br>
    To download or print the problem set or answer key, click one of the export buttons and press <kbd>Ctrl</kbd>+<kbd>P</kbd>. You can print, or save the document as a PDF. Disable print headers for a cleaner document.
    <br><br>
</article>
<form>
    <label for="numProb"><b>Number of Problems (1-1000])</b></label><br>
    <input type="number" id="numProb" min="1" max="1000"><br><br>
    <input type="submit" value="Generate" id="generator">
</form>

<button id="exportProblems">Export Problems</button>
<button id="exportAnswers">Export Answers</button>

<div id="content">
    <h4>Solve each quadratic equation by completing the square.</h4>
    <ol id="problems"></ol>
</div>

<div id="contentAnswers" style="display: none">
    <h4>Solve each quadratic equation by completing the square.</h4>
    <h4 style="color: red;">Answers</h4>
    <ol id="problemsAnswers"></ol>
</div>

<script>
    const exportProblemsButton = document.getElementById('exportProblems');
    const exportAnswersButton = document.getElementById('exportAnswers');
    exportProblemsButton.addEventListener('click', () => {
        const toConvert = document.getElementById('content').innerHTML;
        const newWindow = window.open('', 'PortionWindow', 'width=1000,height=1000,resizable,scrollbars');
        if (newWindow) {
            // deal with CSS
            Array.from(document.getElementsByTagName('link')).forEach(link => {
                if (link.rel === 'stylesheet') {
                    newWindow.document.write(`<link rel="stylesheet" href="${link.href}">`);
                }
            });
            // Copy the content to the new window, including the MathJax script.
            newWindow.document.write('<head><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"><\/script><title>Problem Set<\/title><\/head>');
            newWindow.document.write(toConvert);
            newWindow.document.close();
            newWindow.focus();
        } else {
            alert("Allow pop-ups on this site to export content.")
        }
    });
    exportAnswersButton.addEventListener('click', () => {
        const toConvert = document.getElementById('contentAnswers').innerHTML;
        const newWindow = window.open('', 'PortionWindow', 'width=1000,height=1000,resizable,scrollbars');
        if (newWindow) {
            // deal with CSS
            Array.from(document.getElementsByTagName('link')).forEach(link => {
                if (link.rel === 'stylesheet') {
                    newWindow.document.write(`<link rel="stylesheet" href="${link.href}">`);
                }
            });
            // Copy the content to the new window, including the MathJax script.
            newWindow.document.write('<head><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"><\/script><title>Problem Set Answers<\/title><\/head>');
            newWindow.document.write(toConvert);
            newWindow.document.close();
            newWindow.focus();
        } else {
            alert("Allow pop-ups on this site to export content.")
        }
    });
</script>
<script src="../commonFunctions.js"></script>
<script>
    const problems = document.getElementById("problems");
    const answers = document.getElementById("problemsAnswers");
    document
        .querySelector("#generator")
        .addEventListener('click', () => {
            event.preventDefault()// prevent refresh when form is submitted
            let n = document.querySelector("#numProb").value;
            if (n <= 1000 && n >= 1) {// can change these
                //algorithm here
                for (let i = 0; i < n; i++) {
                    //problem and answer elements go in the list
                    const problem = document.createElement('li');
                    const answer = document.createElement('li');
                    answer.style.color = "red";

                    // Starting with the completed square form (x+-k)^2=d

                    let k = 0;

                    // need a non-zero value for k
                    if(randRange(0,1) === 0){
                        k = randRange(1,10);
                    }else{
                        k = randRange(-10,-1);
                    }
                    const d = squares[randRange(0, squares.length - 1)];
                    const constantTerm = (Math.pow(k,2)-d)
                    if(k > 0){
                        if(constantTerm === 0){
                            problem.innerText = "\\( x^2 +" + (2*k) + "x = 0 \\)";
                        }else if(constantTerm > 0){
                            problem.innerText = "\\( x^2 +" + (2*k) + "x + " + constantTerm + " = 0 \\)";
                        }else{
                            problem.innerText = "\\( x^2 +" + (2*k) + "x" + constantTerm + " = 0 \\)";
                        }
                    }else if(k < 0){
                        if(constantTerm === 0){
                            problem.innerText = "\\( x^2" + (2*k) + "x = 0 \\)";
                        }else if(constantTerm > 0){
                            problem.innerText = "\\( x^2" + (2*k) + "x + " + (Math.pow(k,2)-d) + " = 0 \\)";
                        }else{
                            problem.innerText = "\\( x^2" + (2*k) + "x" + (Math.pow(k,2)-d) + " = 0 \\)";
                        }
                    }else{// this should never run
                        alert("Error. Function randRange(0,1) is working incorrectly.");
                    }

                    answer.innerText = "\\( x = " + ((-1*Math.sqrt(d)) + (-1*k)) + ", " + (Math.sqrt(d) + (-1*k)) + "\\)";

                    problems.appendChild(problem);
                    answers.appendChild(answer);

                    if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
                        MathJax.typesetPromise([problem]).catch(function (err) {
                            console.error('MathJax typesetPromise failed: ' + err.message);
                        });
                    }
                }
            } else {
                alert("You can only generate between 1 and 1000 problems.");
            }
        });
</script>
</body>
</html>